# ksc2022-7

## 08/28からの変更点

08/28の時は，フィッティング関数に縦軸方向のオフセットを入れていた．
```root:fitting1.C
TF1 *f4 = new TF1("f4", "[0]*cos(2*TMath::Pi()*x/[1]) + [2]");
```
けれど，本来アシンメトリーは縦軸方向にオフセットのない三角関数になるべきなので，縦軸方向のオフセットを無くしました．
ついで，時間方向のオフセットを入れました．

```root:fitting1.C
TF1 *f4 = new TF1("f4", "[0]*cos(2*TMath::Pi()*x/[1] + [2])");
```
これをフィッティング関数として採用します．


## 適切なパラメータの探索

DとUのアシンメトリー $A$ は
$$A = \frac{\alpha N_D(t + t_{\textrm{offset}}) - N_U(t)}{\alpha N_D(t + t_{\textrm{offset}}) + N_U(t)}$$
と定義する．ここでパラメータ $\alpha$ はカウンターDとUの検出効率の補正値，パラメータ $t_{\textrm{offset}}$ はDの時間方向のオフセットである．

パラメータ $\alpha$ と $t_{\textrm{offset}}$ を変えながら $A$ を上記のフィッティング関数f4でフィットし，その $\chi^2$ 誤差やProbabilityがよくなるパラメータの値を探索する．


初めに， $0.1 \leq \alpha \leq 5.1$ ,  $-200 \leq t_{\textrm{offset}} \leq 200$の範囲で探索した．
結果， $\chi^2$ 誤差やProbabilityは以下のようになった．
$\chi^2$ 誤差についてのみ対数をとっている．

![find_param_wide](2nd_range.png)

なお，probabilityについて極大値を取る点をorder=0.9で探し，probの図中に黒点で示した．
極大値に振った番号に対応する $\alpha$ と $t_{\textrm{offset}}$の値は以下のようである．
#1  t_offset:-122, alpha:2.12
#2  t_offset:-94, alpha:2.16
#3  t_offset:-38, alpha:2.22
#4  t_offset:-22, alpha:2.24
#5  t_offset:60, alpha:2.34
#6  t_offset:78, alpha:2.36
#7  t_offset:108, alpha:2.40
#8  t_offset:154, alpha:2.46
#9  t_offset:162, alpha:2.48
#10  t_offset:178, alpha:2.50

なお，probで判定した極大点(#1~#10)を $\chi^2 / \textrm{ndf}$ にもプロットしたが，その点の周りで値が小さくなっていることがわかるので抽出した点はフィッティングが良好な点だと判断して良い．

probで判定した極大点(#1~#10)について実際にフィッティングをした結果が以下である．



#6  t_offset:78, alpha:2.36，
#6  t_offset:78, alpha:2.36じs
#6  t_offset:78, alpha:2.36
